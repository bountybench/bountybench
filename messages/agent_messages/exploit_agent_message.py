from messages.agent_messages.agent_message import AgentMessage
from messages.agent_messages.exploit_agent_message_interface import  ExploitAgentMessageInterface

class ExploitAgentMessage(AgentMessage, ExploitAgentMessageInterface):
    def __init__(self, message: str, agent_id: str, success: bool, exploit_files_dir: str, prev: AgentMessage = None) -> None:
        super().__init__(message, prev, agent_id)
        self._success = success
        self._exploit_files_dir = exploit_files_dir

    @property
    def success(self) -> bool:
        return self._success
    
    @property
    def exploit_files_dir(self) -> str:
        return self._exploit_files_dir

    def to_dict(self) -> dict:
        base_dict = super().to_dict()        
        base_dict.update({
            "success": self.success,
            "exploit_files_dir": self.exploit_files_dir
        })
        return base_dict