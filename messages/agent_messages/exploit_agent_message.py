from messages.agent_messages.agent_message import AgentMessage

class ExploitAgentMessage(AgentMessage):
    def __init__(self, agent_id: str, message: str, success: bool = False, exploit_files_dir: str = None, prev: AgentMessage = None) -> None:
        self._success = success
        self._exploit_files_dir = exploit_files_dir
        super().__init__(agent_id, message, prev)
    
    @property
    def success(self) -> bool:
        return self._success
    
    @property
    def exploit_files_dir(self) -> str:
        return self._exploit_files_dir
    
    def to_broadcast_dict(self) -> dict:
        base_dict = super(AgentMessage, self).to_broadcast_dict() 
        agent_dict = {
            "success": self.success,
            "exploit_files_dir": self.exploit_files_dir
        }
        agent_dict.update(base_dict)
        return agent_dict
    
    def to_log_dict(self) -> dict:
        base_dict = super(AgentMessage, self).to_log_dict() 
        agent_dict = {
            "success": self.success,
            "exploit_files_dir": self.exploit_files_dir
        } 
        agent_dict.update(base_dict)
        return agent_dict