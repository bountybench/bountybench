from messages.agent_messages.agent_message import AgentMessage

class ExploitAgentMessage(AgentMessage):
    def __init__(self, agent_id: str, message: str, success: bool = False, exploit_files_dir: str = None, prev: AgentMessage = None) -> None:
        super().__init__(agent_id, prev)
        self._message = message
        self._success = success
        self._exploit_files_dir = exploit_files_dir

    @property
    def message(self) -> str:
        return self._message
    
    @property
    def success(self) -> bool:
        return self._success
    
    @property
    def exploit_files_dir(self) -> str:
        return self._exploit_files_dir
    
    def to_dict(self) -> dict:
        agent_dict = self.agent_dict()
        agent_dict.update({
            "success": self.success,
            "exploit_files_dir": self.exploit_files_dir
        })
        base_dict = super(AgentMessage, self).to_dict() 
        agent_dict.update(base_dict)
        return agent_dict